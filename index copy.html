<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Leilões de Imóveis da Caixa e outros</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: Arial, sans-serif;
      background-color: #f5f5f5;
    }

    /* Menu Responsivo */
    .navbar {
      background-color: #003366;
      color: white;
      padding: 15px 0;
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .container {
      width: 90%;
      max-width: 1200px;
      margin: 0 auto;
    }

    .nav-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      font-size: 1.5rem;
      font-weight: bold;
      color: white;
      text-decoration: none;
    }

    .menu-toggle {
      display: none;
      cursor: pointer;
      font-size: 1.5rem;
    }

    .nav-links {
      display: flex;
      list-style: none;
    }

    .nav-links li {
      margin-left: 20px;
    }

    .nav-links a {
      color: white;
      text-decoration: none;
      transition: color 0.3s;
    }

    .nav-links a:hover {
      color: #ffcc00;
    }

    /* Conteúdo principal */
    .main-content {
      padding: 20px;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
      color: #003366;
    }

    input[type="file"] {
      margin-bottom: 20px;
      width: 100%;
      max-width: 400px;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }

    select {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      min-width: 150px;
      background-color: white;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      margin-bottom: 20px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    th, td {
      padding: 10px;
      border: 1px solid #ddd;
      text-align: left;
    }

    .info-box {
      background-color: white;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    #link-cef {
      text-align: center;
      margin: 15px 0;
    }

    #link-cef a {
      color: #003366;
      font-weight: bold;
      text-decoration: none;
    }

    #link-cef a:hover {
      text-decoration: underline;
    }

    th {
      background-color: #003366;
      color: white;
    }

    tr:nth-child(even) {
      background-color: #f9f9f9;
    }

    tr:hover {
      background-color: #f1f1f1;
    }

    /* Rodapé */
    footer {
      background-color: #003366;
      color: white;
      text-align: center;
      padding: 20px 0;
      margin-top: 30px;
    }

    /* Responsividade */
    @media (max-width: 768px) {
      .menu-toggle {
        display: block;
      }

      .nav-links {
        display: none;
        flex-direction: column;
        width: 100%;
        position: absolute;
        top: 60px;
        left: 0;
        background-color: #003366;
        padding: 20px 0;
      }

      .nav-links.active {
        display: flex;
      }

      .nav-links li {
        margin: 10px 0;
        text-align: center;
      }

      .filters {
        flex-direction: column;
      }

      select {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <!-- Menu Responsivo -->
  <nav class="navbar">
    <div class="container nav-container">
      <a href="#" class="logo">iMobi</a>
      <div class="menu-toggle">☰</div>
      <ul class="nav-links">
        <li><a href="#">Home</a></li>
        <li><a href="leiloeiros.html">Leiloeiros</a></li>
        <li><a href="#contato">Contato</a></li>
      </ul>
    </div>
  </nav>

  <div class="main-content container">
    <h1>Imóveis de Leilão</h1>
    
    <div class="info-box">
      <p id="link-cef">1. Para baixar a lista de imóveis da caixa, acesse <a href="https://venda-imoveis.caixa.gov.br/sistema/download-lista.asp" target="_blank">este link</a></p>
      <p id="link-cef">2. Para acessar + de 200 calculadoras e ferramentas online, acesse <a href="https://icontrolweb.com.br/" target="_blank">este link</a></p>
    </div>

    <input type="file" id="csvFile" accept=".csv">
    
    <div class="filters">
      <select id="ufFilter"><option value="">UF</option></select>
      <select id="cidadeFilter"><option value="">Cidade</option></select>
      <select id="bairroFilter"><option value="">Bairro</option></select>
      <select id="modalidadeFilter"><option value="">Modalidade</option></select>
    </div>

    <table id="dataTable">
      <thead>
        <tr>
          <th>UF</th>
          <th>Cidade</th>
          <th>Bairro</th>
          <th>Endereço</th>
          <th>Preço</th>
          <th>Valor Avaliação</th>
          <th>Desconto</th>
          <th>Modalidade</th>
          <th>Link</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <footer id="contato">
    <div class="container">
      <p>© 2025 Imóveis de Leilão - Todos os direitos reservados</p>
      <p>Contato: senadorx@gmail.com ||  (11) 96131-2020 - Tiago</p>
    </div>
  </footer>

  <script>
    // Menu responsivo
    document.querySelector('.menu-toggle').addEventListener('click', function() {
      document.querySelector('.nav-links').classList.toggle('active');
    });

    // Código original para manipulação do CSV
    let originalData = [];

    document.getElementById('csvFile').addEventListener('change', function (e) {
      const file = e.target.files[0];
      const reader = new FileReader();

      reader.onload = function (event) {
        const lines = event.target.result.split('\n').slice(4); // pula cabeçalhos falsos
        const data = lines
          .map(line => line.trim().split(';'))
          .filter(cols => cols.length >= 11);

        originalData = data.map(cols => ({
          uf: cols[1],
          cidade: cols[2],
          bairro: cols[3],
          endereco: cols[4],
          preco: cols[5],
          avaliacao: cols[6],
          desconto: cols[7],
          modalidade: cols[9],
          link: cols[10]
        }));

        localStorage.setItem("imoveis", JSON.stringify(originalData));
        preencherFiltros(originalData);
        renderTable(originalData);
      };

      reader.readAsText(file, 'ISO-8859-1');
    });

    function preencherFiltros(data) {
      const ufs = new Set();
      const cidades = new Set();
      const bairros = new Set();
      const modalidades = new Set();

      data.forEach(item => {
        ufs.add(item.uf);
        cidades.add(item.cidade);
        bairros.add(item.bairro);
        modalidades.add(item.modalidade);
      });

      preencherSelect("ufFilter", ufs);
      preencherSelect("cidadeFilter", cidades);
      preencherSelect("bairroFilter", bairros);
      preencherSelect("modalidadeFilter", modalidades);
    }

    function preencherSelect(id, values) {
      const select = document.getElementById(id);
      select.innerHTML = '<option value="">' + select.firstChild.textContent + '</option>';
      values = Array.from(values).sort();
      values.forEach(value => {
        const option = document.createElement("option");
        option.value = value;
        option.textContent = value;
        select.appendChild(option);
      });
    }

    function renderTable(data) {
      const tbody = document.querySelector("#dataTable tbody");
      tbody.innerHTML = "";
      data.forEach(item => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${item.uf}</td>
          <td>${item.cidade}</td>
          <td>${item.bairro}</td>
          <td>${item.endereco}</td>
          <td>${formatarMoeda(item.preco)}</td>
          <td>${formatarMoeda(item.avaliacao)}</td>
          <td>${item.desconto}</td>
          <td>${item.modalidade}</td>
          <td><a href="${item.link}" target="_blank">Acessar</a></td>
        `;
        tbody.appendChild(row);
      });
    }

    function formatarMoeda(valor) {
      if (!valor) return '';
      valor = valor.replace(',', '.');
      const num = parseFloat(valor);
      if (isNaN(num)) return valor;
      return num.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'});
    }

    const filtros = ["ufFilter", "cidadeFilter", "bairroFilter", "modalidadeFilter"];
    filtros.forEach(filtroId => {
      document.getElementById(filtroId).addEventListener("change", () => {
        const filtrosAtuais = {
          uf: document.getElementById("ufFilter").value,
          cidade: document.getElementById("cidadeFilter").value,
          bairro: document.getElementById("bairroFilter").value,
          modalidade: document.getElementById("modalidadeFilter").value
        };

        const filtrado = originalData.filter(item => {
          return (!filtrosAtuais.uf || item.uf === filtrosAtuais.uf) &&
                 (!filtrosAtuais.cidade || item.cidade === filtrosAtuais.cidade) &&
                 (!filtrosAtuais.bairro || item.bairro === filtrosAtuais.bairro) &&
                 (!filtrosAtuais.modalidade || item.modalidade === filtrosAtuais.modalidade);
        });

        renderTable(filtrado);
      });
    });

    // Carregar dados do localStorage se existirem
    const savedData = localStorage.getItem("imoveis");
    if (savedData) {
      originalData = JSON.parse(savedData);
      preencherFiltros(originalData);
      renderTable(originalData);
    }
  </script>
</body>
</html>